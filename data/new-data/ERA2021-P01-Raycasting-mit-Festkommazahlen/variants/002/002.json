{
  "case_id": "new-data/ERA2021-P01-Raycasting-mit-Festkommazahlen/002",
  "issues": [
    {
      "description": "The Problem Statement's Requirements Update says: \"The function `fix_div` must calculate the division of two fixed-point numbers and return the result as a standard IEEE 754 `float`\" (problem_statement.md). However, both the template and the solution declare and implement fix_div to return a fixed-point type (fix_t). The prototype in math_fix.h declares fix_t fix_div(fix_t a, fix_t b); and math_fix.c implements inline fix_t fix_div(...). Call sites (for example, ray_triangle_intersect.cpp expects a fix_t return and assigns to fix_t invDet) rely on the existing fix_t return type. This is a direct return-type mismatch: the problem statement requires a float return but the template and solution APIs and callers use fix_t. Students will be confused which API to implement and will be blocked: returning float would require changing the public prototype and many callers (and possibly arithmetic helpers), while implementing the current prototype would violate the updated requirement.",
      "severity": "HIGH",
      "category": "METHOD_RETURN_TYPE_MISMATCH",
      "related_locations": [
        {
          "type": "PROBLEM_STATEMENT",
          "file_path": "problem_statement.md",
          "start_line": 25,
          "end_line": 26
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/example_program/src/math_fix.h",
          "start_line": 40,
          "end_line": 44
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/example_program/src/math_fix.c",
          "start_line": 46,
          "end_line": 53
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/example_program/src/ray_triangle_intersect.cpp",
          "start_line": 60,
          "end_line": 63
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/example_program/src/math_fix.h",
          "start_line": 40,
          "end_line": 44
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/example_program/src/math_fix.c",
          "start_line": 46,
          "end_line": 53
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/example_program/src/ray_triangle_intersect.cpp",
          "start_line": 60,
          "end_line": 63
        }
      ],
      "suggested_fix": "Bring the specification and code back into agreement. Two viable options:\n\nOption A (recommended, minimal disruption): Revert or clarify the Requirements Update in problem_statement.md so that `fix_div` is specified to return fix_t (the existing API), but allow/require that the implementation may use floating-point internally for intermediate precision if desired. Example wording: \"fix_div should compute a/b for fixed-point operands. Implementations may use float/double internally to improve precision, but the function must keep the existing API and return type (fix_t).\"\n\nOption B (larger API change): If the intention truly is for fix_div to return float, update the template and solution code consistently: change the prototype in math_fix.h to `float fix_div(fix_t a, fix_t b);`, update the implementation in math_fix.c to return a float (perform conversions using fix_fix2float or similar), and update all call sites (e.g., in ray_triangle_intersect.cpp) to expect a float and to adapt downstream arithmetic (invDet, multiplications, and any uses of fix_mul/fix_div) accordingly. Document the migration steps for students. \n\nPrefer Option A unless you also intend to update all callers and helpers in the template/solution to the new float-return API."
    }
  ]
}
