{
  "case_id": "newData/ERA2021-H03-Grafikspeicher/016",
  "issues": [
    {
      "description": "The buffer 'buf' is declared too small (buf resd 2 -> 8 bytes) while the code performs reads of up to 9 bytes for the color and 5 bytes for x/y. Reading 9 bytes into an 8-byte buffer overflows the buffer. This appears in both the template and the solution and can cause memory corruption or crashes, confusing students when their code behaves unexpectedly.",
      "severity": "HIGH",
      "category": "ATTRIBUTE_TYPE_MISMATCH",
      "related_locations": [
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/pixel.asm",
          "start_line": 20,
          "end_line": 22
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/pixel.asm",
          "start_line": 130,
          "end_line": 136
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/pixel.asm",
          "start_line": 57,
          "end_line": 63
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/pixel.asm",
          "start_line": 4,
          "end_line": 6
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/pixel.asm",
          "start_line": 112,
          "end_line": 117
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/pixel.asm",
          "start_line": 31,
          "end_line": 36
        }
      ],
      "suggested_fix": "Make the input buffer large enough for the largest read. For example, replace 'buf resd 2' with 'buf resb 16' (or at least 'resb 10') so the buffer can hold the 9 bytes read for the color plus a terminating byte. Alternatively, adjust the read sizes (edx) to match the actual buffer size. Ensure the buffer size is consistent in both template and solution."
    },
    {
      "description": "The display_start reservation uses 'RESD 8294400'. RESD allocates 8294400 dwords (4 bytes each), i.e. ~33,177,600 bytes, which is four times the expected framebuffer size. The intended framebuffer for 1920Ã—1080 at 4 bytes/pixel is 8,294,400 bytes (either RESB 8294400 or RESD 2073600). This mismatch in the bss declaration is structural and may confuse students about how to reserve the framebuffer memory.",
      "severity": "MEDIUM",
      "category": "ATTRIBUTE_TYPE_MISMATCH",
      "related_locations": [
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/pixel.asm",
          "start_line": 20,
          "end_line": 21
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/pixel.asm",
          "start_line": 4,
          "end_line": 5
        },
        {
          "type": "PROBLEM_STATEMENT",
          "file_path": "problem_statement.md",
          "start_line": 30,
          "end_line": 33
        }
      ],
      "suggested_fix": "Reserve the framebuffer with the correct unit. Either reserve bytes explicitly: 'display_start RESB 8294400' (8294400 bytes = 1920*1080*4), or reserve dwords for pixel words: 'display_start RESD 2073600' (2073600 dwords * 4 = 8294400 bytes). Update both template and solution to use the same correct declaration."
    },
    {
      "description": "The problem statement asks students to \"Schreiben Sie das Unterprogramm draw_pixel\" (implement a subroutine named draw_pixel), but both the template and the reference solution use the label set_pixel for that subroutine. This mismatch can confuse students: they may implement or look for draw_pixel (as stated in the task) and not find it in the template, or implement a new label draw_pixel that is not called by the provided main. This creates an unnecessary mapping burden between the textual requirement and the code.",
      "severity": "HIGH",
      "category": "IDENTIFIER_NAMING_INCONSISTENCY",
      "related_locations": [
        {
          "type": "PROBLEM_STATEMENT",
          "file_path": "problem_statement.md",
          "start_line": 30,
          "end_line": 33
        },
        {
          "type": "TEMPLATE_REPOSITORY",
          "file_path": "template_repository/pixel.asm",
          "start_line": 36,
          "end_line": 38
        },
        {
          "type": "SOLUTION_REPOSITORY",
          "file_path": "solution_repository/pixel.asm",
          "start_line": 153,
          "end_line": 168
        }
      ],
      "suggested_fix": "Use a single consistent name for the pixel-drawing subroutine across all artifacts. Either: (a) change the problem statement to refer to set_pixel instead of draw_pixel, or (b) rename the label set_pixel to draw_pixel in the template and solution (and update all calls). This alignment avoids students implementing or searching for a differently named routine."
    }
  ]
}
